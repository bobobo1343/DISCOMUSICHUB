import os
import json
import urllib.parse

repo_base = "https://raw.githubusercontent.com/bobobo1343/DISCOMUSICHUB/main/audio"

artists = ["Carti", "Ken", "Lone"]
playlist = {}

for artist in artists:
    playlist[artist] = []
    artist_folder = f"./audio/{artist}"  # local path
    for root, dirs, files in os.walk(artist_folder):
        for file in files:
            if file.lower().endswith((".mp3", ".m4a", ".wav")):
                # Generate title as Era/Subfolder + filename
                subpath = os.path.relpath(root, artist_folder)
                title = os.path.join(subpath, os.path.splitext(file)[0]).replace("\\", "/")
                # Encode file path for GitHub raw URL
                url_path = urllib.parse.quote(os.path.join(artist, subpath, file).replace("\\", "/"))
                url = f"{repo_base}/{url_path}"
                playlist[artist].append({"title": title, "url": url})

with open("playlist.json", "w", encoding="utf-8") as f:
    json.dump(playlist, f, indent=2)
