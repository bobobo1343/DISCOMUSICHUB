<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carti Music Player</title>
<style>
  body {margin:0;font-family:Arial,sans-serif;background:#111;color:#fff;}
  .player-container {display:flex;height:calc(100vh - 80px);}
  .sidebar {width:250px;background:#1a1a1a;padding:20px;overflow-y:auto;}
  .sidebar h2 {text-align:center;margin-top:0;}
  .eras button {width:100%;margin:5px 0;padding:10px;background:#222;border:none;color:#fff;cursor:pointer;text-align:left;}
  .eras button:hover {background:#333;}
  .playlist-container {flex:1;overflow-y:auto;padding:20px;}
  .playlist-container ul {list-style:none;padding:0;}
  .playlist-container li {padding:8px;cursor:pointer;}
  .playlist-container li:hover {background:#333;}
  .artwork-container {width:300px;display:flex;align-items:center;justify-content:center;background:#1a1a1a;padding:20px;position:sticky;top:0;}
  .artwork-container img {max-width:100%;border-radius:10px;}
  .playback-bar {height:80px;background:#222;display:flex;align-items:center;padding:0 20px;gap:10px;flex-wrap:wrap;}
  .playback-bar input[type=range]{flex:1;}
  button {background:#222;color:#fff;border:none;padding:5px 10px;cursor:pointer;border-radius:5px;}
  button:hover {background:#333;}
</style>
</head>
<body>

<div class="player-container">
  <!-- Sidebar -->
  <div class="sidebar">
    <h2>Playboi Carti</h2>
    <div class="eras" id="eras"></div>
  </div>

  <!-- Playlist -->
  <div class="playlist-container">
    <ul id="playlist"></ul>
  </div>

  <!-- Artwork -->
  <div class="artwork-container">
    <img id="artwork" src="https://raw.githubusercontent.com/bobobo1343/ARTWORK/main/default%20(2).jpg" alt="Artwork">
  </div>
</div>

<!-- Playback Bar -->
<div class="playback-bar">
  <button id="prev">‚èÆ</button>
  <button id="play">‚ñ∂Ô∏è</button>
  <button id="next">‚è≠</button>
  <button id="shuffle">üîÄ</button>
  <button id="repeat">üîÅ</button>
  <span id="current-time">0:00</span>
  <input type="range" id="seek" min="0" value="0">
  <span id="duration">0:00</span>
  <input type="range" id="volume" min="0" max="1" step="0.01" value="1">
</div>

<script>
let playlist = [], currentSongs = [], currentIndex = 0;
let audio = new Audio();
let shuffleMode=false, repeatMode=false;

// Load playlist.json from GitHub
fetch('https://raw.githubusercontent.com/bobobo1343/DISCOMUSICHUB/main/playlist.json')
  .then(res => res.json())
  .then(data => {
    playlist = data['Carti'];
    generateEras(playlist);
    // default: load first era
    let firstEra = Object.keys(groupByEra(playlist))[0];
    loadSongs(groupByEra(playlist)[firstEra]);
  })
  .catch(err => alert('Error loading playlist: '+err));

// Group songs by era (first folder in title)
function groupByEra(songs){
  let eras = {};
  songs.forEach(s=>{
    let era = s.title.split('/')[0] || 'Singles';
    if(!eras[era]) eras[era]=[];
    eras[era].push(s);
  });
  return eras;
}

// Generate sidebar era buttons
function generateEras(songs){
  const erasDiv = document.getElementById('eras');
  erasDiv.innerHTML='';
  let eras = groupByEra(songs);
  for(const era in eras){
    let btn=document.createElement('button');
    btn.textContent=era;
    btn.onclick=()=>loadSongs(eras[era]);
    erasDiv.appendChild(btn);
  }
}

// Load songs into playlist
function loadSongs(songsArr){
  currentSongs = songsArr;
  const playlistEl = document.getElementById('playlist');
  playlistEl.innerHTML='';
  songsArr.forEach((s,idx)=>{
    let li=document.createElement('li');
    li.textContent = s.title.split('/').pop();
    li.onclick=()=>playSong(idx);
    playlistEl.appendChild(li);
  });
  playSong(0);
}

// Play selected song
function playSong(idx){
  currentIndex=idx;
  let song=currentSongs[currentIndex];
  audio.src=song.url;
  audio.play();
  document.getElementById('artwork').src = song.artwork || 'https://raw.githubusercontent.com/bobobo1343/ARTWORK/main/default%20(2).jpg';
  highlightPlaying();
}

// Highlight the current song in playlist
function highlightPlaying(){
  document.querySelectorAll('#playlist li').forEach((li,i)=>{
    li.style.background = (i===currentIndex)?'#555':'';
  });
}

// Playback controls
document.getElementById('play').onclick=()=>audio.paused?audio.play():audio.pause();
document.getElementById('next').onclick=()=>nextSong();
document.getElementById('prev').onclick=()=>prevSong();
document.getElementById('shuffle').onclick=()=>shuffleMode=!shuffleMode;
document.getElementById('repeat').onclick=()=>repeatMode=!repeatMode;
document.getElementById('seek').oninput=(e)=>audio.currentTime=e.target.value;
document.getElementById('volume').oninput=(e)=>audio.volume=e.target.value;

// Audio events
audio.ontimeupdate=()=>{
  document.getElementById('current-time').textContent=formatTime(audio.currentTime);
  document.getElementById('seek').value=audio.currentTime;
  document.getElementById('duration').textContent=formatTime(audio.duration||0);
};

audio.onended=()=>{
  if(repeatMode) playSong(currentIndex);
  else nextSong();
};

function nextSong(){
  if(shuffleMode) currentIndex=Math.floor(Math.random()*currentSongs.length);
  else currentIndex=(currentIndex+1)%currentSongs.length;
  playSong(currentIndex);
}

function prevSong(){
  currentIndex=(currentIndex-1+currentSongs.length)%currentSongs.length;
  playSong(currentIndex);
}

function formatTime(sec){
  let m=Math.floor(sec/60), s=Math.floor(sec%60);
  return `${m}:${s<10?'0'+s:s}`;
}
</script>

</body>
</html>
